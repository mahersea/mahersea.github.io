<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Satellite Tracker</title>
</head>
<body>
  <canvas id="satCanvas" width="600" height="400" style="border:1px solid #000000;"></canvas>
  <script src="https://unpkg.com/satellite.js/dist/satellite.min.js"></script>
  <script>
    const canvas = document.getElementById('satCanvas');
    const ctx = canvas.getContext('2d');

    // Function to fetch satellite data from the server
    async function fetchSatelliteData() {
      try {
        const response = await fetch('/satellite');
        const data = await response.json();
        return data.position;
      } catch (error) {
        console.error('Error fetching satellite data:', error);
      }
    }

    // Simple function to convert lat/long to canvas coordinates
    function latLongToCanvas(lat, lon) {
      // Map longitude from -180 to 180 to canvas width
      const x = ((lon + 180) / 360) * canvas.width;
      // Map latitude from 90 to -90 to canvas height (invert y-axis)
      const y = ((90 - lat) / 180) * canvas.height;
      return { x, y };
    }

    // Function to render the satellite position
    async function renderSatellite() {
      const position = await fetchSatelliteData();
      if (position) {
        const { latitude, longitude } = position;
        const { x, y } = latLongToCanvas(latitude, longitude);

        // Clear canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // Draw satellite position as a circle
        ctx.beginPath();
        ctx.arc(x, y, 5, 0, 2 * Math.PI);
        ctx.fillStyle = 'red';
        ctx.fill();

        // Display coordinates for reference
        ctx.fillStyle = 'black';
        ctx.font = '14px Arial';
        ctx.fillText(`Lat: ${latitude.toFixed(2)}°, Lon: ${longitude.toFixed(2)}°`, 10, 20);
      }
    }

    // Update every 5 seconds
    setInterval(renderSatellite, 5000);
    // Initial render
    renderSatellite();
  </script>
</body>
</html>
